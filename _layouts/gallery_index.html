<!DOCTYPE html>
<html>
  {% include head.html %}
  <body>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
      $(function() {
        i = 0;
        $('.menuAc').css({'color': 'rgba(52, 152, 219, 1)'});
        $('.menuAc').click(function(){
          $(this).next('.menuMobil').animate({width:'toggle'},350);
          if (i%2==0) {
            $('.footer, .yazilar, .ust').css({'filter':'blur(5px)'});
            $('ul.menu').css({'animation-duration': '0.1s'});
            i++;
          } else {
            $('.footer, .yazilar, .ust').css({'filter':'blur(0px)'});
            i++;
          }
        });
      });
    </script>

    <div class="menuAc">
      <i class="fa fa-bars" aria-hidden="true"></i>
    </div>
    <div class="menuMobil">
      {% include nav-home.html %}
    </div>

    <div class="ust">
      <div class="ortalaAna">
        <div class="baslikAna">
          {{ site.title }}
        </div>
        <div class="pc">
          {% include nav.html %}
        </div>
      </div>
    </div>

    <div class="ortalaAna">
      <div class="yazilar">
        <div class="yazi">
          <div class="ustr">
            <h2>{{ page.title }}</h2>
          </div>
          <hr>

          <div class="content">

            <style>
              .galleries-grid {
                display: grid;
                gap: 1rem;
                grid-template-columns: repeat(3, minmax(0, 1fr));
              }
              @media (max-width: 960px) { .galleries-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
              @media (max-width: 520px) { .galleries-grid { grid-template-columns: 1fr; } }

              .gallery-card {
                display:block; text-decoration:none; color:inherit;
                border-radius: 12px; overflow:hidden; background:#fff;
                box-shadow: 0 1px 6px rgba(0,0,0,.06);
                transition: transform .15s ease, box-shadow .15s ease;
              }
              .gallery-card:hover { transform: translateY(-2px); box-shadow: 0 6px 18px rgba(0,0,0,.08); }
              .gallery-card img { width:100%; height:auto; display:block; }
              .gallery-card .meta { padding:.75rem 1rem; }
              .gallery-card .ttl { font-weight:600; margin:0 0 .25rem; }
              .gallery-card .desc { color:#666; margin:0; font-size:.95rem; }
            </style>

            <div class="galleries-grid">
              {%- comment -%}
                Mostra tutte le pagine con layout "gallery".
                Ogni card ha:
                - cover: presa da p.cover_image se definita,
                         altrimenti prima immagine trovata in p.dir_images
              {%- endcomment -%}
              {%- assign pages_gallery = site.pages | where: "layout", "gallery" -%}
              {%- for p in pages_gallery -%}
                {%- assign cover = p.cover_image -%}

                {%- if cover == nil or cover == "" -%}
                  {%- assign base_path = '/' | append: p.dir_images | append: '/' -%}
                  {%- assign imgs = site.static_files | where_exp: "f", "f.path contains base_path" -%}
                  {%- assign found = "" -%}
                  {%- for f in imgs -%}
                    {%- assign ext = f.extname | downcase -%}
                    {%- if ext == ".jpg" or ext == ".jpeg" or ext == ".png" or ext == ".gif" or ext == ".webp" -%}
                      {%- assign found = f.path -%}
                      {%- break -%}
                    {%- endif -%}
                  {%- endfor -%}
                  {%- assign cover = found -%}
                {%- endif -%}

                <a class="gallery-card" href="{{ p.url | relative_url }}">
                  {%- if cover and cover != "" -%}
                    <img
                      src="{{ cover | relative_url }}"
                      alt="Anteprima {{ p.title | escape }}"
                      loading="lazy" decoding="async">
                  {%- endif -%}
                  <div class="meta">
                    <p class="ttl">{{ p.title }}</p>
                    {%- if p.description -%}
                      <p class="desc">{{ p.description }}</p>
                    {%- endif -%}
                  </div>
                </a>
              {%- endfor -%}
            </div>

          </div>
        </div>

        {% include scripts.html %}
      </div>
    </div>

    {% include footer.html %}
  </body>
</html>
